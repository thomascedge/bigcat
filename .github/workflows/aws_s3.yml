# name: Deploy to S3.

# on:
#   push:
#     branches:
#       - main
#   pull_request:
#     branches:
#       - main

# jobs:   
#   integration:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout repository
#         uses: actions/checkout@v4

#       - name: Set up Python
#         uses: actions/setup-python@v5
#         with:
#           python-version: '3.10'

#       - name: Install Dependencies
#         working-directory: ./app
#         run: pip install -r requirements.txt

#       - name: Package Application
#         run: |
#           mkdir -p package
#           cp -r app/* package/
#           pip install -r app/requirements.txt -t package/
#           cd package
#           zip -r ../api.zip .
#           cd ..

#   deploy:
#     runs-on: ubuntu-latest
#     needs: [integration]
#     steps:
#       - name: Login to AWS
#         uses: aws-actions/configure-aws-credentials@v4
#         with:
#           aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#           aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#           aws-region: us-east-1

#       - name: Download Lambda api.zip
#         uses: actions/download-artifact@v4
#         with:
#           name: app

#       - name: Upload to S3
#         run: aws s3 cp api.zip s3://bigcat-thomas/api.zip
#         env:
#           AWS_ACCESS_KEY_ID: ${{ secrets.AWS_SECRET_ACCESS_KEY_ID }}
#           AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#           AWS_DEFAULT_REGION: us-east-1

#       - name: Deploy new Lambda
#         run: aws lambda update-function-code --function-name fastapi --s3-bucket bigcat-thomas --s3-key api.zip
#         env:
#           AWS_ACCESS_KEY_ID: ${{ secrets.AWS_SECRET_ACCESS_KEY_ID }}
#           AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#           AWS_DEFAULT_REGION: us-east-1